<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd">
    <changeSet id="0001-1" author="kartven">
        <createTable tableName="users">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_users"/>
            </column>
            <column name="password" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="is_account_expired" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="is_account_locked" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="is_credentials_expired" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="is_enabled" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="role" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="staffs">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_staffs"/>
            </column>
            <column name="reference_id" type="VARCHAR(20)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="first_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="last_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_street" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_zip_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_city" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_post_dist" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_students_user" references="users(id)"/>
            </column>
        </createTable>

        <createIndex indexName="idx_reference_id" tableName="staffs">
            <column name="reference_id"/>
        </createIndex>

        <createTable tableName="students">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_students"/>
            </column>
            <column name="first_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="last_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_street" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_zip_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_city" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="address_post_dist" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_students_user" references="users(id)"/>
            </column>
        </createTable>

        <createTable tableName="faculties">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_faculties"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="shortname" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="year_founded" type="INT"/>
            <column name="address" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="courses">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_courses"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="faculty_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_courses_faculty" references="faculties(id)"/>
            </column>
        </createTable>

        <createTable tableName="programmes">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_programmes"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="shortname" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="course_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_programmes_course" references="courses(id)"/>
            </column>
        </createTable>

        <createTable tableName="modules">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_modules"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="ects" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="hours" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="is_exam" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="programme_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_modules_programme" references="programmes(id)"/>
            </column>
        </createTable>

        <createTable tableName="academic_years">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_academic_years"/>
            </column>
            <column name="semesters" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="range" type="VARCHAR(9)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="groups">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_groups"/>
            </column>
            <column name="number" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="type" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="connections">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_connections"/>
            </column>
            <column name="module_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_connections_module" references="modules(id)"/>
            </column>
            <column name="academic_year_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_connections_academic_year" references="academic_years(id)"/>
            </column>
            <column name="group_id" type="BIGINT">
                <constraints nullable="false" foreignKeyName="fk_connections_group" references="groups(id)"/>
            </column>
        </createTable>

        <createTable tableName="staff_connections">
            <column name="staff_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" foreignKeyName="fk_stacon_staff" references="staffs(id)"/>
            </column>
            <column name="connection_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" foreignKeyName="fk_stacon_connection" references="connections(id)"/>
            </column>
        </createTable>

        <createTable tableName="student_connections">
            <column name="student_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" foreignKeyName="fk_stucon_student" references="students(id)"/>
            </column>
            <column name="connection_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" foreignKeyName="fk_stucon_connection" references="connections(id)"/>
            </column>
        </createTable>
        <createTable tableName="works">
            <column name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_works"/>
            </column>
            <column name="position" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="staff_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" foreignKeyName="fk_works_staff" references="staffs(id)"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="0001-2" author="KartVen" context="test">
        <!--<sql>
            insert into users (password, is_account_expired, is_account_locked, is_credentials_expired, is_enabled, role)
            values  ('$2a$10$MEZyKrAQ7CB6RGhmOyBnw.TB5z/Ev2Z2GBw7uDGxOldYgQxgBHZSW', false, false, false, true, 'ADMINISTRATOR'),
                    ('$2a$10$TCNuJakmKcn02uebpoplDOrCAolFRQnCWoCXsj7wYDzA5TkcyH3GC', false, false, false, true, 'LECTURER'),
                    ('$2a$10$GhpXBbwYCJ0h5eZCVvPIBeT9D4Oybej5PT0587F.7HryOhkTwYVLi', false, false, false, true, 'LECTURER'),
                    ('$2a$10$32s2c/EnoBkScqhrrJbeOOo6TiyWevGG1KmXJLbsgLsAWGj513yMS', false, false, false, true, 'STUDENT'),
                    ('$2a$10$gzuXPaJ2UMuvICaHTDVu3u6ljaUCaJDnwf3C741rwE9ZEy91pEIRy', false, false, false, true, 'STUDENT'),
                    ('$2a$10$vOvXeMOUMF.ff/qyvbBxSO2aqBOyFOVJTGmLH/6TmLVlOg9Y80.Uy', false, false, false, true, 'STUDENT');
        </sql>

        <sql>
            insert into staffs (id, first_name, last_name, user_id)
            values  ('kkielbasa', 'Krystian', 'Kiełbasa', 1),
                    ('jnowak', 'Jan', 'Nowak', 2),
                    ('anowak', 'Anna', 'Nowak', 3);

        </sql>

        <sql>
            insert into students (first_name, last_name, user_id)
            values  ('Kuba', 'Kowalski', 4),
                    ('Piotr', 'Kowalski', 5),
                    ('Filip', 'Kowalski', 6);
        </sql>

        <sql>
            insert into faculties (address, name, shortname)
            values ('al. Powstańców Warszawy 8, 35 - 959 Rzeszów', 'Wydział Budowy Maszyn i Lotnictwa', 'WBMIL'),
                   ('al. Powstańców Warszawy 6, 35-959 Rzeszów', 'Wydział Chemiczny', 'CHEMIA'),
                   ('ul. Wincentego Pola 2, 35-959 Rzeszów', 'Wydział Elektrotechniki i Informatyki', 'WEII'),
                   ('al. Powstańców Warszawy 8, 35-959 Rzeszów', 'Wydział Matematyki i Fizyki Stosowanej', 'WMIFS'),
                   ('al. Powstańców Warszawy 10, 35-959 Rzeszów', 'Wydział Zarządzania', 'WZ');
        </sql>

        <sql>
            insert into courses (name, faculty_id)
            values ('Automatyka i robotyka', 3),
                   ('Elektronika i telekomunikacja', 3),
                   ('Elektrotechnika', 3),
                   ('Informatyka', 3),
                   ('Elektromobilność', 3);
        </sql>

        <sql>
            insert into academic_years (semesters, range)
            values  (7, '2020/2021'),
                    (7, '2021/2022'),
                    (7, '2022/2023'),
                    (7, '2023/2024');
        </sql>

        <sql>
            insert into programmes (name, shortname, course_id)
            values  ('Inżynieria systemów informatycznych', 'AA', 4),
                    ('Systemy i sieci komputerowe', 'S', 4),
                    ('Informatyka w przedsiębiorstwie', 'TT', 4),
                    ('Inżynieria systemów złożonych', 'Z', 4);
        </sql>

        <sql>
            insert into modules (name, ects, hours, is_exam, programme_id)
            values  ('Fizyka', 6, 75, true, 1),
                    ('Programowanie w języku C', 4, 45, false, 1),
                    ('Sygnały i systemy', 5, 60, true, 1),
                    ('Wstęp do programowania', 4, 45, false, 1),
                    ('Języki, automaty i obliczenia', 5, 55, true, 1),
                    ('Logika i teoria mnogości', 2, 30, false, 1),
                    ('Narzędzia dla programistów', 3, 40, false, 1),
                    ('Technika informacyjno-pomiarowa', 5, 60, false, 1);
        </sql>

        <sql>
            insert into groups (number, type)
            values (1, 'W'),
                   (1, 'C'),
                   (2, 'C'),
                   (1, 'L'),
                   (2, 'L'),
                   (3, 'L'),
                   (4, 'L'),
                   (1, 'P'),
                   (2, 'P'),
                   (3, 'P'),
                   (4, 'P');
        </sql>

        <sql>
            insert into connections (module_id, academic_year_id, group_id)
            values  (1, 1, 1),
                    (1, 1, 2),
                    (1, 1, 4),
                    (1, 1, 8),
                    (2, 1, 1),
                    (2, 1, 2),
                    (2, 1, 4),
                    (2, 1, 8),
                    (3, 2, 1),
                    (3, 2, 2),
                    (3, 2, 4),
                    (3, 2, 8),
                    (4, 2, 1),
                    (4, 2, 2),
                    (4, 2, 4),
                    (4, 2, 8),
                    (5, 3, 1),
                    (5, 3, 2),
                    (5, 3, 4),
                    (5, 3, 8),
                    (6, 3, 1),
                    (6, 3, 2),
                    (6, 3, 4),
                    (6, 3, 8),
                    (7, 4, 1),
                    (7, 4, 2),
                    (7, 4, 4),
                    (7, 4, 8),
                    (8, 4, 1),
                    (8, 4, 2),
                    (8, 4, 4),
                    (8, 4, 8);
        </sql>-->
    </changeSet>
</databaseChangeLog>